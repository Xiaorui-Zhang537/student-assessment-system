# 📋 数据库连接操作指南

## 🎯 当前配置状态

### ✅ 配置文件已准备就绪
在 `src/main/resources/application.yml` 中，数据库配置已正确设置：
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/student_assessment_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: Ab*83327000
    driver-class-name: com.mysql.cj.jdbc.Driver
```

## 🚀 数据库连接步骤

### 第1步：确保MySQL服务运行

#### macOS系统：
```bash
# 启动MySQL服务
brew services start mysql

# 或者使用系统偏好设置启动MySQL
```

#### Windows系统：
```bash
# 以管理员身份运行命令提示符
net start mysql
```

#### Linux系统：
```bash
# Ubuntu/Debian
sudo systemctl start mysql

# CentOS/RHEL
sudo systemctl start mysqld
```

### 第2步：连接MySQL并创建数据库

```bash
# 连接到MySQL（使用root账号）
mysql -u root -p
# 输入密码：Ab*83327000
```

在MySQL命令行中执行：
```sql
-- 创建数据库
CREATE DATABASE IF NOT EXISTS student_assessment_system 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 查看数据库是否创建成功
SHOW DATABASES;

-- 使用数据库
USE student_assessment_system;

-- 退出MySQL
EXIT;
```

### 第3步：初始化数据库表和数据

#### 方式1：使用MySQL命令行执行脚本
```bash
# 在backend目录下执行
mysql -u root -p student_assessment_system < src/main/resources/schema.sql
mysql -u root -p student_assessment_system < src/main/resources/data.sql
```

#### 方式2：手动执行SQL脚本
```bash
# 连接数据库
mysql -u root -p student_assessment_system

# 在MySQL命令行中执行
SOURCE src/main/resources/schema.sql;
SOURCE src/main/resources/data.sql;

# 检查表是否创建成功
SHOW TABLES;

# 检查测试数据是否插入成功
SELECT * FROM users;
SELECT * FROM courses;
```

### 第4步：测试应用连接

```bash
# 启动Spring Boot应用
mvn spring-boot:run

# 或者编译后运行
mvn clean package
java -jar target/assessment-0.0.1-SNAPSHOT.jar
```

## 🔍 连接验证

### 检查应用启动日志
启动成功后，你应该看到类似这样的日志：
```
...
2024-12-28 10:00:00.000  INFO --- [main] com.zaxxer.hikari.HikariDataSource      : HikariPool-1 - Starting...
2024-12-28 10:00:00.000  INFO --- [main] com.zaxxer.hikari.HikariDataSource      : HikariPool-1 - Start completed.
...
2024-12-28 10:00:00.000  INFO --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http)
2024-12-28 10:00:00.000  INFO --- [main] c.n.assessment.AssessmentApplication     : Started AssessmentApplication in 3.456 seconds
```

### 测试API接口
```bash
# 测试健康检查
curl http://localhost:8080/api/actuator/health

# 测试登录接口
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"teacher","password":"123456"}'
```

## 🛠️ 故障排除

### 连接被拒绝
如果遇到 "Connection refused" 错误：
1. 确保MySQL服务正在运行
2. 检查端口3306是否被占用
3. 验证用户名和密码是否正确

### 权限错误
如果遇到权限错误，root用户通常有所有权限，但如果需要可以执行：
```sql
-- 确保root用户有完整权限
GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' WITH GRANT OPTION;
FLUSH PRIVILEGES;
```

### 字符编码问题
确保MySQL配置支持UTF-8：
```sql
-- 检查字符集设置
SHOW VARIABLES LIKE 'character_set%';
SHOW VARIABLES LIKE 'collation%';
```

## 📊 预置测试账号

数据库初始化后，你可以使用以下账号测试：

| 角色  | 用户名      | 密码     | 说明      |
|-----|----------|--------|---------|
| 管理员 | admin    | 123456 | 系统管理员权限 |
| 教师  | teacher  | 123456 | 教师功能    |
| 教师  | teacher2 | 123456 | 第二个教师账号 |
| 学生  | student  | 123456 | 学生功能    |
| 学生  | student2 | 123456 | 第二个学生账号 |
| 学生  | student3 | 123456 | 第三个学生账号 |

## 🎯 下一步

1. **启动后端服务**：`mvn spring-boot:run`
2. **验证API文档**：访问 http://localhost:8080/api/swagger-ui.html
3. **测试前端连接**：使用预置账号登录前端应用
4. **开始开发**：所有API接口已就绪，可以开始全栈开发！

---

## 📞 需要帮助？

如果在连接过程中遇到任何问题，请提供具体的错误信息，我会帮你快速解决！ 